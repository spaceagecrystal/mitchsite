/**
 * easyXDM
 * http://easyxdm.net/
 * Copyright(c) 2009-2011, Ã˜yvind Sean Kinsey, oyvind@kinsey.no.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
(function(I,c,l,F,g,C){var b=this;var j=Math.floor(Math.random()*100)*100;var m=Function.prototype;var L=/^(http.?:\/\/([^\/\s]+))/;var M=/[\-\w]+\/\.\.\//;var A=/([^:])\/\//g;var D="";var k={};var H=I.easyXDM;var P="easyXDM_";var z;function x(S,U){var T=typeof S[U];return T=="function"||(!!(T=="object"&&S[U]))||T=="unknown"}function q(S,T){return !!(typeof(S[T])=="object"&&S[T])}function n(S){return Object.prototype.toString.call(S)==="[object Array]"}var r,t;if(x(I,"addEventListener")){r=function(U,S,T){U.addEventListener(S,T,false)};t=function(U,S,T){U.removeEventListener(S,T,false)}}else{if(x(I,"attachEvent")){r=function(S,U,T){S.attachEvent("on"+U,T)};t=function(S,U,T){S.detachEvent("on"+U,T)}}else{throw new Error("Browser not supported")}}var R=false,E=[],G;if("readyState" in c){G=c.readyState;R=G=="complete"||(~navigator.userAgent.indexOf("AppleWebKit/")&&(G=="loaded"||G=="interactive"))}else{R=!!c.body}function o(){o=m;R=true;for(var S=0;S<E.length;S++){E[S]()}E.length=0}if(!R){if(x(I,"addEventListener")){r(c,"DOMContentLoaded",o)}else{r(c,"readystatechange",function(){if(c.readyState=="complete"){o()}});if(c.documentElement.doScroll&&I===top){(function e(){if(R){return}try{c.documentElement.doScroll("left")}catch(S){F(e,1);return}o()}())}}r(I,"load",o)}function B(T,S){if(R){T.call(S);return}E.push(function(){T.call(S)})}function i(){var U=parent;if(D!==""){for(var S=0,T=D.split(".");S<T.length;S++){U=U[T[S]]}}return U.easyXDM}function d(S){I.easyXDM=H;D=S;if(D){P="easyXDM_"+D.replace(".","_")+"_"}return k}function u(S){return S.match(L)[2]}function f(S){return S.match(L)[1]}function w(S){S=S.replace(A,"$1/");if(!S.match(/^(http||https):\/\//)){var T=(S.substring(0,1)==="/")?"":l.pathname;if(T.substring(T.length-1)!=="/"){T=T.substring(0,T.lastIndexOf("/")+1)}S=l.protocol+"//"+l.host+T+S}while(M.test(S)){S=S.replace(M,"")}return S}function K(S,V){var X="",U=S.indexOf("#");if(U!==-1){X=S.substring(U);S=S.substring(0,U)}var W=[];for(var T in V){if(V.hasOwnProperty(T)){W.push(T+"="+C(V[T]))}}return S+((S.indexOf("?")===-1)?"?":"&")+W.join("&")+X}var N=(function(){var U={},V,T=l.search.substring(1).split("&"),S=T.length;while(S--){V=T[S].split("=");U[V[0]]=g(V[1])}return U}());function p(S){return typeof S==="undefined"}function J(){var T={};var U={a:[1,2,3]},S='{"a":[1,2,3]}';if(JSON&&typeof JSON.stringify==="function"&&JSON.stringify(U).replace((/\s/g),"")===S){return JSON}if(Object.toJSON){if(Object.toJSON(U).replace((/\s/g),"")===S){T.stringify=Object.toJSON}}if(typeof String.prototype.evalJSON==="function"){U=S.evalJSON();if(U.a&&U.a.length===3&&U.a[2]===3){T.parse=function(V){return V.evalJSON()}}}if(T.stringify&&T.parse){J=function(){return T};return T}return null}function O(S,T,U){var W;for(var V in T){if(T.hasOwnProperty(V)){if(V in S){W=T[V];if(typeof W==="object"){O(S[V],W,U)}else{if(!U){S[V]=T[V]}}}else{S[V]=T[V]}}}return S}function a(){var S=c.createElement("iframe");S.name=P+"TEST";O(S.style,{position:"absolute",left:"-2000px",top:"0px"});c.body.appendChild(S);z=!(S.contentWindow===I.frames[S.name]);c.body.removeChild(S)}function v(S){if(p(z)){a()}var T;if(z){T=c.createElement('<iframe name="'+S.props.name+'"/>')}else{T=c.createElement("IFRAME");T.name=S.props.name}T.id=T.name=S.props.name;delete S.props.name;if(S.onLoad){r(T,"load",S.onLoad)}if(typeof S.container=="string"){S.container=c.getElementById(S.container)}if(!S.container){T.style.position="absolute";T.style.left="-2000px";T.style.top="0px";S.container=c.body}T.border=T.frameBorder=0;S.container.insertBefore(T,S.container.firstChild);O(T,S.props);return T}function Q(V,U){if(typeof V=="string"){V=[V]}var T,S=V.length;while(S--){T=V[S];T=new RegExp(T.substr(0,1)=="^"?T:("^"+T.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"));if(T.test(U)){return true}}return false}function h(U){var Z=U.protocol,T;U.isHost=U.isHost||p(N.xdm_p);if(!U.props){U.props={}}if(!U.isHost){U.channel=N.xdm_c;U.secret=N.xdm_s;U.remote=N.xdm_e;Z=N.xdm_p;if(U.acl&&!Q(U.acl,U.remote)){throw new Error("Access denied for "+U.remote)}}else{U.remote=w(U.remote);U.channel=U.channel||"default"+j++;U.secret=Math.random().toString(16).substring(2);if(p(Z)){if(f(l.href)==f(U.remote)){Z="4"}else{if(x(I,"postMessage")||x(c,"postMessage")){Z="1"}else{if(x(I,"ActiveXObject")&&x(I,"execScript")){Z="3"}else{if(navigator.product==="Gecko"&&"frameElement" in I&&navigator.userAgent.indexOf("WebKit")==-1){Z="5"}else{if(U.remoteHelper){U.remoteHelper=w(U.remoteHelper);Z="2"}else{Z="0"}}}}}}}switch(Z){case"0":O(U,{interval:100,delay:2000,useResize:true,useParent:false,usePolling:false},true);if(U.isHost){if(!U.local){var X=l.protocol+"//"+l.host,S=c.body.getElementsByTagName("img"),Y;var V=S.length;while(V--){Y=S[V];if(Y.src.substring(0,X.length)===X){U.local=Y.src;break}}if(!U.local){U.local=I}}var W={xdm_c:U.channel,xdm_p:0};if(U.local===I){U.usePolling=true;U.useParent=true;U.local=l.protocol+"//"+l.host+l.pathname+l.search;W.xdm_e=U.local;W.xdm_pa=1}else{W.xdm_e=w(U.local)}if(U.container){U.useResize=false;W.xdm_po=1}U.remote=K(U.remote,W)}else{O(U,{channel:N.xdm_c,remote:N.xdm_e,useParent:!p(N.xdm_pa),usePolling:!p(N.xdm_po),useResize:U.useParent?false:U.useResize})}T=[new k.stack.HashTransport(U),new k.stack.ReliableBehavior({}),new k.stack.QueueBehavior({encode:true,maxLength:4000-U.remote.length}),new k.stack.VerifyBehavior({initiate:U.isHost})];break;case"1":T=[new k.stack.PostMessageTransport(U)];break;case"2":T=[new k.stack.NameTransport(U),new k.stack.QueueBehavior(),new k.stack.VerifyBehavior({initiate:U.isHost})];break;case"3":T=[new k.stack.NixTransport(U)];break;case"4":T=[new k.stack.SameOriginTransport(U)];break;case"5":T=[new k.stack.FrameElementTransport(U)];break}T.push(new k.stack.QueueBehavior({lazy:U.lazy,remove:true}));return T}function y(V){var W,U={incoming:function(Y,X){this.up.incoming(Y,X)},outgoing:function(X,Y){this.down.outgoing(X,Y)},callback:function(X){this.up.callback(X)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(var T=0,S=V.length;T<S;T++){W=V[T];O(W,U,true);if(T!==0){W.down=V[T-1]}if(T!==S-1){W.up=V[T+1]}}return W}function s(S){S.up.down=S.down;S.down.up=S.up;S.up=S.down=null}O(k,{version:"2.4.10.5",query:N,stack:{},apply:O,getJSONObject:J,whenReady:B,noConflict:d});k.DomHelper={on:r,un:t,requiresJSON:function(S){if(!q(I,"JSON")){c.write('<script type="text/javascript" src="'+S+'"><\/script>')}}};(function(){var S={};k.Fn={set:function(T,U){S[T]=U},get:function(U,T){var V=S[U];if(T){delete S[U]}return V}}}());k.Socket=function(T){var S=y(h(T).concat([{incoming:function(W,V){T.onMessage(W,V)},callback:function(V){if(T.onReady){T.onReady(V)}}}])),U=f(T.remote);this.origin=f(T.remote);this.destroy=function(){S.destroy()};this.postMessage=function(V){S.outgoing(V,U)};S.init()};k.Rpc=function(U,T){if(T.local){for(var W in T.local){if(T.local.hasOwnProperty(W)){var V=T.local[W];if(typeof V==="function"){T.local[W]={method:V}}}}}var S=y(h(U).concat([new k.stack.RpcBehavior(this,T),{callback:function(X){if(U.onReady){U.onReady(X)}}}]));this.origin=f(U.remote);this.destroy=function(){S.destroy()};S.init()};k.stack.SameOriginTransport=function(T){var U,W,V,S;return(U={outgoing:function(Y,Z,X){V(Y);if(X){X()}},destroy:function(){if(W){W.parentNode.removeChild(W);W=null}},onDOMReady:function(){S=f(T.remote);if(T.isHost){O(T.props,{src:K(T.remote,{xdm_e:l.protocol+"//"+l.host+l.pathname,xdm_c:T.channel,xdm_p:4}),name:P+T.channel+"_provider"});W=v(T);k.Fn.set(T.channel,function(X){V=X;F(function(){U.up.callback(true)},0);return function(Y){U.up.incoming(Y,S)}})}else{V=i().Fn.get(T.channel,true)(function(X){U.up.incoming(X,S)});F(function(){U.up.callback(true)},0)}},init:function(){B(U.onDOMReady,U)}})};k.stack.PostMessageTransport=function(V){var X,Y,T,U;function S(Z){if(Z.origin){return Z.origin}if(Z.uri){return f(Z.uri)}if(Z.domain){return l.protocol+"//"+Z.domain}throw"Unable to retrieve the origin of the event"}function W(aa){var Z=S(aa);if(Z==U&&aa.data.substring(0,V.channel.length+1)==V.channel+" "){X.up.incoming(aa.data.substring(V.channel.length+1),Z)}}return(X={outgoing:function(aa,ab,Z){T.postMessage(V.channel+" "+aa,ab||U);if(Z){Z()}},destroy:function(){t(I,"message",W);if(Y){T=null;Y.parentNode.removeChild(Y);Y=null}},onDOMReady:function(){U=f(V.remote);if(V.isHost){r(I,"message",function Z(aa){if(aa.data==V.channel+"-ready"){T=("postMessage" in Y.contentWindow)?Y.contentWindow:Y.contentWindow.document;t(I,"message",Z);r(I,"message",W);F(function(){X.up.callback(true)},0)}});O(V.props,{src:K(V.remote,{xdm_e:l.protocol+"//"+l.host,xdm_c:V.channel,xdm_p:1}),name:P+V.channel+"_provider"});Y=v(V)}else{r(I,"message",W);T=("postMessage" in I.parent)?I.parent:I.parent.document;T.postMessage(V.channel+"-ready",U);F(function(){X.up.callback(true)},0)}},init:function(){B(X.onDOMReady,X)}})};k.stack.FrameElementTransport=function(T){var U,W,V,S;return(U={outgoing:function(Y,Z,X){V.call(this,Y);if(X){X()}},destroy:function(){if(W){W.parentNode.removeChild(W);W=null}},onDOMReady:function(){S=f(T.remote);if(T.isHost){O(T.props,{src:K(T.remote,{xdm_e:l.protocol+"//"+l.host+l.pathname+l.search,xdm_c:T.channel,xdm_p:5}),name:P+T.channel+"_provider"});W=v(T);W.fn=function(X){delete W.fn;V=X;F(function(){U.up.callback(true)},0);return function(Y){U.up.incoming(Y,S)}}}else{I.parent.location=N.xdm_e+"#";V=I.frameElement.fn(function(X){U.up.incoming(X,S)});U.up.callback(true)}},init:function(){B(U.onDOMReady,U)}})};k.stack.NixTransport=function(T){var V,X,W,S,U;return(V={outgoing:function(Z,aa,Y){W(Z);if(Y){Y()}},destroy:function(){U=null;if(X){X.parentNode.removeChild(X);X=null}},onDOMReady:function(){S=f(T.remote);if(T.isHost){try{if(!x(I,"getNixProxy")){I.execScript("Class NixProxy\n    Private m_parent, m_child, m_Auth\n\n    Public Sub SetParent(obj, auth)\n        If isEmpty(m_Auth) Then m_Auth = auth\n        SET m_parent = obj\n    End Sub\n    Public Sub SetChild(obj)\n        SET m_child = obj\n        m_parent.ready()\n    End Sub\n\n    Public Sub SendToParent(data, auth)\n        If m_Auth = auth Then m_parent.send(CStr(data))\n    End Sub\n    Public Sub SendToChild(data, auth)\n        If m_Auth = auth Then m_child.send(CStr(data))\n    End Sub\nEnd Class\nFunction getNixProxy()\n    Set GetNixProxy = New NixProxy\nEnd Function\n","vbscript")}U=getNixProxy();U.SetParent({send:function(aa){V.up.incoming(aa,S)},ready:function(){F(function(){V.up.callback(true)},0)}},T.secret);W=function(aa){U.SendToChild(aa,T.secret)}}catch(Z){throw new Error("Could not set up VBScript NixProxy:"+Z.message)}O(T.props,{src:K(T.remote,{xdm_e:l.protocol+"//"+l.host+l.pathname+l.search,xdm_c:T.channel,xdm_s:T.secret,xdm_p:3}),name:P+T.channel+"_provider"});X=v(T);X.contentWindow.opener=U}else{I.parent.location=N.xdm_e+"#";try{U=I.opener}catch(Y){throw new Error("Cannot access window.opener")}U.SetChild({send:function(aa){b.setTimeout(function(){V.up.incoming(aa,S)},0)}});W=function(aa){U.SendToParent(aa,T.secret)};F(function(){V.up.callback(true)},0)}},init:function(){B(V.onDOMReady,V)}})};k.stack.NameTransport=function(W){var X;var Z,ad,V,ab,ac,T,S;function aa(ag){var af=W.remoteHelper+(Z?"#_3":"#_2")+W.channel;ad.contentWindow.sendMessage(ag,af)}function Y(){if(Z){if(++ab===2||!Z){X.up.callback(true)}}else{aa("ready");X.up.callback(true)}}function ae(af){X.up.incoming(af,T)}function U(){if(ac){F(function(){ac(true)},0)}}return(X={outgoing:function(ag,ah,af){ac=af;aa(ag)},destroy:function(){ad.parentNode.removeChild(ad);ad=null;if(Z){V.parentNode.removeChild(V);V=null}},onDOMReady:function(){Z=W.isHost;ab=0;T=f(W.remote);W.local=w(W.local);if(Z){k.Fn.set(W.channel,function(ag){if(Z&&ag==="ready"){k.Fn.set(W.channel,ae);Y()}});S=K(W.remote,{xdm_e:W.local,xdm_c:W.channel,xdm_p:2});O(W.props,{src:S+"#"+W.channel,name:P+W.channel+"_provider"});V=v(W)}else{W.remoteHelper=W.remote;k.Fn.set(W.channel,ae)}ad=v({props:{src:W.local+"#_4"+W.channel},onLoad:function af(){t(ad,"load",af);k.Fn.set(W.channel+"_load",U);(function ag(){if(typeof ad.contentWindow.sendMessage=="function"){Y()}else{F(ag,50)}}())}})},init:function(){B(X.onDOMReady,X)}})};k.stack.HashTransport=function(U){var X;var ac=this,aa,V,S,Y,ah,W,ag;var ab,T;function af(aj){if(!ag){return}var ai=U.remote+"#"+(ah++)+"_"+aj;((aa||!ab)?ag.contentWindow:ag).location=ai}function Z(ai){Y=ai;X.up.incoming(Y.substring(Y.indexOf("_")+1),T)}function ae(){if(!W){return}var ai=W.location.href,ak="",aj=ai.indexOf("#");if(aj!=-1){ak=ai.substring(aj)}if(ak&&ak!=Y){Z(ak)}}function ad(){V=setInterval(ae,S)}return(X={outgoing:function(ai,aj){af(ai)},destroy:function(){I.clearInterval(V);if(aa||!ab){ag.parentNode.removeChild(ag)}ag=null},onDOMReady:function(){aa=U.isHost;S=U.interval;Y="#"+U.channel;ah=0;ab=U.useParent;T=f(U.remote);if(aa){U.props={src:U.remote,name:P+U.channel+"_provider"};if(ab){U.onLoad=function(){W=I;ad();X.up.callback(true)}}else{var ak=0,ai=U.delay/50;(function aj(){if(++ak>ai){throw new Error("Unable to reference listenerwindow")}try{W=ag.contentWindow.frames[P+U.channel+"_consumer"]}catch(al){}if(W){ad();X.up.callback(true)}else{F(aj,50)}}())}ag=v(U)}else{W=I;ad();if(ab){ag=parent;X.up.callback(true)}else{O(U,{props:{src:U.remote+"#"+U.channel+new Date(),name:P+U.channel+"_consumer"},onLoad:function(){X.up.callback(true)}});ag=v(U)}}},init:function(){B(X.onDOMReady,X)}})};k.stack.ReliableBehavior=function(T){var V,X;var W=0,S=0,U="";return(V={incoming:function(aa,Y){var Z=aa.indexOf("_"),ab=aa.substring(0,Z).split(",");aa=aa.substring(Z+1);if(ab[0]==W){U="";if(X){X(true)}}if(aa.length>0){V.down.outgoing(ab[1]+","+W+"_"+U,Y);if(S!=ab[1]){S=ab[1];V.up.incoming(aa,Y)}}},outgoing:function(aa,Y,Z){U=aa;X=Z;V.down.outgoing(S+","+(++W)+"_"+aa,Y)}})};k.stack.QueueBehavior=function(U){var X,Y=[],ab=true,V="",aa,S=0,T=false,W=false;function Z(){if(U.remove&&Y.length===0){s(X);return}if(ab||Y.length===0||aa){return}ab=true;var ac=Y.shift();X.down.outgoing(ac.data,ac.origin,function(ad){ab=false;if(ac.callback){F(function(){ac.callback(ad)},0)}Z()})}return(X={init:function(){if(p(U)){U={}}if(U.maxLength){S=U.maxLength;W=true}if(U.lazy){T=true}else{X.down.init()}},callback:function(ad){ab=false;var ac=X.up;Z();ac.callback(ad)},incoming:function(af,ad){if(W){var ae=af.indexOf("_"),ac=parseInt(af.substring(0,ae),10);V+=af.substring(ae+1);if(ac===0){if(U.encode){V=g(V)}X.up.incoming(V,ad);V=""}}else{X.up.incoming(af,ad)}},outgoing:function(ag,ad,af){if(U.encode){ag=C(ag)}var ac=[],ae;if(W){while(ag.length!==0){ae=ag.substring(0,S);ag=ag.substring(ae.length);ac.push(ae)}while((ae=ac.shift())){Y.push({data:ac.length+"_"+ae,origin:ad,callback:ac.length===0?af:null})}}else{Y.push({data:ag,origin:ad,callback:af})}if(T){X.down.init()}else{Z()}},destroy:function(){aa=true;X.down.destroy()}})};k.stack.VerifyBehavior=function(W){var X,V,T,U=false;function S(){V=Math.random().toString(16).substring(2);X.down.outgoing(V)}return(X={incoming:function(aa,Y){var Z=aa.indexOf("_");if(Z===-1){if(aa===V){X.up.callback(true)}else{if(!T){T=aa;if(!W.initiate){S()}X.down.outgoing(aa)}}}else{if(aa.substring(0,Z)===T){X.up.incoming(aa.substring(Z+1),Y)}}},outgoing:function(aa,Y,Z){X.down.outgoing(V+"_"+aa,Y,Z)},callback:function(Y){if(W.initiate){S()}}})};k.stack.RpcBehavior=function(Y,T){var V,aa=T.serializer||J();var Z=0,X={};function S(ab){ab.jsonrpc="2.0";V.down.outgoing(aa.stringify(ab))}function W(ab,ad){var ac=Array.prototype.slice;return function(){var ae=arguments.length,ag,af={method:ad};if(ae>0&&typeof arguments[ae-1]==="function"){if(ae>1&&typeof arguments[ae-2]==="function"){ag={success:arguments[ae-2],error:arguments[ae-1]};af.params=ac.call(arguments,0,ae-2)}else{ag={success:arguments[ae-1]};af.params=ac.call(arguments,0,ae-1)}X[""+(++Z)]=ag;af.id=Z}else{af.params=ac.call(arguments,0)}if(ab.namedParams&&af.params.length===1){af.params=af.params[0]}S(af)}}function U(ai,ah,ad,ag){if(!ad){if(ah){S({id:ah,error:{code:-32601,message:"Procedure not found."}})}return}var af,ac;if(ah){af=function(aj){af=m;S({id:ah,result:aj})};ac=function(aj,ak){ac=m;var al={id:ah,error:{code:-32099,message:aj}};if(ak){al.error.data=ak}S(al)}}else{af=ac=m}if(!n(ag)){ag=[ag]}try{var ab=ad.method.apply(ad.scope,ag.concat([af,ac]));if(!p(ab)){af(ab)}}catch(ae){ac(ae.message)}}return(V={incoming:function(ac,ab){var ad=aa.parse(ac);if(ad.method){if(T.handle){T.handle(ad,S)}else{U(ad.method,ad.id,T.local[ad.method],ad.params)}}else{var ae=X[ad.id];if(ad.error){if(ae.error){ae.error(ad.error)}}else{if(ae.success){ae.success(ad.result)}}delete X[ad.id]}},init:function(){if(T.remote){for(var ab in T.remote){if(T.remote.hasOwnProperty(ab)){Y[ab]=W(T.remote[ab],ab)}}}V.down.init()},destroy:function(){for(var ab in T.remote){if(T.remote.hasOwnProperty(ab)&&Y.hasOwnProperty(ab)){delete Y[ab]}}V.down.destroy()}})};b.easyXDM=k})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);window.cloudsponge=(function(){(function(){if(typeof(String.prototype.strip)!=="function"){String.prototype.strip=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}}if(typeof(Object.create)!=="function"){Object.create=function(o){var F=function(){};F.prototype=o;return new F()}}}());function merge(toObj,fromObj){for(var key in fromObj){if(fromObj.hasOwnProperty(key)){toObj[key]=fromObj[key]}}return toObj}function csWarn(log_txt){if(window.console!==undefined){console.log(log_txt)}}function eventPush(obj,event,handler){if(obj.addEventListener){obj.addEventListener(event,handler,false)}else{if(obj.attachEvent){obj.attachEvent("on"+event,handler)}}}function addJavascript(jsname,pos){var first_script=document.getElementsByTagName("script")[0];var s=document.createElement("script");s.setAttribute("type","text/javascript");s.setAttribute("src",jsname);first_script.parentNode.insertBefore(s,first_script)}function addCss(cssname,pos){var first_script=document.getElementsByTagName("script")[0];var s=document.createElement("link");s.setAttribute("type","text/css");s.setAttribute("rel","stylesheet");s.setAttribute("media","screen");s.setAttribute("href",cssname);first_script.parentNode.insertBefore(s,first_script)}function constructQueryString(obj){var params=[];for(var name in obj){if(typeof obj[name]!=="function"&&typeof obj[name]!=="undefined"){params.push(name+"="+encodeURIComponent(obj[name]))}}return params.join("&")}var isMobileSafari=navigator.userAgent.match(/Mobile.+Safari/i);var rpc=null;var rpc_ready=false;var defaultOptions={include:["name","email"],initiallySelectedContacts:false,displaySelectAllNone:true,mobile_render:false,cache_contacts:true};var csOptions=merge({},defaultOptions);var totalWaitTime=0,waitInterval=250;var brandFloatbox=function brandFloatbox(){
/*@cc_on
          var appVer = navigator.appVersion;
          if (parseInt(appVer.substr(appVer.indexOf('MSIE') + 5), 10) < 7) return;
      @*/
var div=document.createElement("div");div.id="brand";fb.setInnerHTML(div,'<a href="http://www.cloudsponge.com/" onclick="window.open(this.href);return false;" style="float:right;margin-top:20px;border:none;border-width:0;"><img alt="Powered_by-grey" onmouseout="this.src=\'https://csponge-production.s3.amazonaws.com/images/address_books/powered_by-grey.png?1296510503\'" onmouseover="this.src=\'https://csponge-production.s3.amazonaws.com/images/address_books/powered_by-color.png?1296510503\'" src="https://csponge-production.s3.amazonaws.com/images/address_books/powered_by-grey.png?1296510503" style="border-width:0;" /></a><span style="float:right;color:white;font-size:10px;font-family:verdana;margin-top:23px;margin-right:10px">powered by</span>');fb.fbBox.appendChild(div)};var unbrandFloatbox=function unbrandFloatbox(){
/*@cc_on
          var appVer = navigator.appVersion;
          if (parseInt(appVer.substr(appVer.indexOf('MSIE') + 5), 10) < 7) return;
      @*/
fb$("brand").style.display="none"};var loadFloatbox=function loadFloatbox(){var query_string=constructQueryString(csOptions);var iframe=window.document.createElement("iframe");iframe.id=iframe.name="cs_container_frame";iframe.src="https://api.cloudsponge.com/address_books/?"+query_string;iframe.setAttribute("frameBorder","0");iframe.style.width="100%";iframe.style.height="100%";eventPush(iframe,"load",function(){resizeIframe()});fb$("cs_container").appendChild(iframe);return true};var resizeIframe=function resizeIframe(){var contentWrapper=fb$("fbContentWrapper"),iframe=fb$("cs_container_frame");if(contentWrapper&&iframe){iframe.style.height=contentWrapper.style.height}};var resizeIframeWidth=function resizeIframeWidth(){setFrameRect({top:0,left:0,width:document.body.clientWidth})};var unloadFloatbox=function unloadFloatbox(){var iframe=fb$("cs_container_frame");if(iframe){iframe.parentElement.removeChild(iframe)}return true};var endingFloatbox=function endingFloatbox(){if(rpc){rpc.unloadFrame()}unloadFloatbox()};function extendContacts(contacts){var email_accessors={selectedEmail:function(){for(var i=0;i<this.email.length;i++){if(this.email[i].selected){return this.email[i].address}}return this.primaryEmail()},primaryEmail:function(){return this.email[0].address},fullName:function(){return(this.first_name||"")+" "+(this.last_name||"")}};for(var i=0;i<contacts.length;i++){for(var attrname in email_accessors){if(attrname){contacts[i][attrname]=email_accessors[attrname]}}}return contacts}function formatRecipient(name,email){if(name&&name.strip().length>0){return'"'+name.replace('"',"&quot;")+'" <'+email+">"}else{return email}}function contactsToString(contacts,includes,seperator){if(seperator===undefined){seperator=", "}var email_only=(includes.toString().indexOf("name")<0);var mod_contacts=[];for(var i=0;i<contacts.length;i++){if(email_only){mod_contacts[i]=contacts[i].selectedEmail()}else{mod_contacts[i]=formatRecipient(contacts[i].fullName(),contacts[i].selectedEmail())}}return mod_contacts.join(seperator)}function tryCallback(callback,args){var result=null;if(csOptions[callback]!==undefined){try{result=csOptions[callback](args)}catch(e){csWarn("Attempt to invoke callback ["+callback+"] failed: "+e)}}return result}function assignValue(id,value){list_element=fb$(csOptions[id]);if(list_element){list_element.value=value}}function csLaunchWithTracking(){try{var myTracker=_gat._getTrackerByName();_gaq.push(["myTracker._trackEvent","widget","launch"]);setTimeout(csLaunch,100)}catch(err){}}function setCSAnchorAttributes(a){a.setAttribute("data-cs-init",true);if(!a.getAttribute("href")){a.setAttribute("href","#cs_container")}a.onclick=function(){return csLaunch()}}function optionsToQueryString(hashOfOptions){var params=[];var i=0;for(var key in hashOfOptions){if(key){params[i++]=key+"="+escape(hashOfOptions[key])}}return params.join("&")}function handleContacts(contacts,options){response_value=contactsToString(contacts,options.include);assignValue("textarea_id",response_value);if(typeof(onImportComplete)!="undefined"){try{onImportComplete(response_value)}catch(e){csWarn("Attempt to invoke [onImportComplete] failed: "+e)}}}function rpcReady(){rpc_ready=true;var elements=document.getElementsByTagName("div");var i,element,a;for(i=0;i<elements.length;i++){element=elements[i];if(element.className=="cs_import"&&element.getAttribute("data-cs-init")===null){link_visible=true;a=document.createElement("a");setCSAnchorAttributes(a);a.innerHTML="Add from Address Book";element.appendChild(a)}}elements=document.getElementsByTagName("a");for(i=0;i<elements.length;i++){element=elements[i];if(element.className=="cs_import"&&element.getAttribute("data-cs-init")===null){link_visible=true;setCSAnchorAttributes(element)}}var b=document.getElementsByTagName("body")[0];var d=document.createElement("div");d.setAttribute("id","cs_container");d.style.display="none";b.appendChild(d);a=document.createElement("a");setCSAnchorAttributes(a);a.id="cs_link";a.style.display="none";b.appendChild(a);tryCallback("afterInit")}function easyXDMReady(){link_visible=false;try{rpc=new easyXDM.Rpc({onReady:rpcReady,remote:"https://api.cloudsponge.com/address_books/provider?domain_key="+csOptions.domain_key},{local:{getOptions:function(successFn,errorFn){return csOptions},afterClose:function(successFn,errorFn){tryCallback("afterClose",null);fb.end()},beforeDisplayContacts:function(data,successFn,errorFn){var contacts=extendContacts(data);if(contacts){var result=tryCallback("beforeDisplayContacts",contacts);if(result===false){handleContacts(contacts,csOptions);fb.end()}}},afterSubmitContacts:function(data,successFn,errorFn){var contacts=extendContacts(data);handleContacts(contacts,csOptions);tryCallback("afterSubmitContacts",contacts);fb.end()},resizeFrame:function(newDims,successFn,errorFn){var overlay=fb$("fbOverlay");var pageHeight=getDocHeight();var pageWidth=document.body.clientWidth;var rect={top:0,left:0,height:Math.max(newDims.height,pageHeight),width:Math.max(newDims.width,pageWidth)};setFrameRect(rect)}},remote:{unloadFrame:{}}})}catch(e){var error_detail="{";for(var prop in e){if(e.hasOwnProperty(prop)){error_detail+=prop+": "+e[prop]+" "}}error_detail+="}";csWarn("easyXDM.Rpc exception: "+error_detail)}}function setFrameRect(rect){var frame=fb$("cs_container_frame");var wrapper=fb$("fbContentWrapper");var box=fb$("fbBox");if(frame&&wrapper&&box){if(rect.width){wrapper.style.width=frame.style.width=rect.width+"px"}if(rect.height){wrapper.style.height=frame.style.height=rect.height+"px"}if(rect.top!==undefined&&rect.top!==null){box.style.top=rect.top+"px"}if(rect.left!==undefined&&rect.left!==null){box.style.left=rect.left+"px"}window.scrollTo(0,window.scrollY)}}function getDocHeight(){var D=document;return Math.max(Math.max(D.body.scrollHeight,D.documentElement.scrollHeight),Math.max(D.body.offsetHeight,D.documentElement.offsetHeight),Math.max(D.body.clientHeight,D.documentElement.clientHeight))}easyXDM.DomHelper.requiresJSON("https://csponge-production.s3.amazonaws.com/javascripts/address_books/json2.min.js");function checkEasyXDMReady(){if(easyXDM!==undefined&&window.JSON!==undefined&&csOptions.domain_key!==undefined){if(window.JSON!==undefined){easyXDMReady()}}else{if(totalWaitTime++<20){setTimeout(checkEasyXDMReady,waitInterval)}else{csWarn("Unable to load easyXDM, cannot initialize widget.")}}}function includeFBOptions(){addJavascript("https://csponge-production.s3.amazonaws.com/javascripts/address_books/options.js","script");checkEasyXDMReady()}var init=function(options){merge(csOptions,options);if(csOptions.mobile_render&&isMobileSafari){window.onresize=resizeIframeWidth;window.document.body.onorientationchange=resizeIframeWidth;merge(floatboxOptions,mobileFloatboxOptions)}};var launch=function(){if(rpc_ready&&tryCallback("beforeLaunch")!==false){fb.start(fb$("cs_link"))}return false};addCss("https://csponge-production.s3.amazonaws.com/javascripts/address_books/floatbox.css","script");var floatboxOptions={afterFBLoaded:includeFBOptions,type:"iframe",width:410,height:487,scrolling:"no",outerBorder:1,innerBorder:0,padding:20,disableScroll:true,outsideClickCloses:false,enableKeyboardNav:false,controlsPos:"tr",resizeDuration:2.5,startAtClick:false,afterBoxStart:loadFloatbox,afterItemStart:brandFloatbox,beforeBoxEnd:function(){endingFloatbox();unbrandFloatbox()}};var mobileFloatboxOptions={width:"100%",height:"100%",boxLeft:0,boxTop:0,roundCorners:"none",outerBorder:0,padding:0,panelPadding:0,shadowType:"none",shadowSize:0,showClose:false,afterItemStart:function(){},beforeBoxEnd:endingFloatbox};window.csLaunch=launch;window.csInit=init;window.fbPageOptions=floatboxOptions;return{init:init,launch:csLaunch,options:csOptions,isMobileSafari:isMobileSafari}}());/*******************************************************************************************************
* Floatbox v4.21.cloudcopy
* November 23, 2010
*
* Copyright (c) 2008-2010 Byron McGregor
* Website: http://randomous.com/floatbox
* This software and all associated files are protected by copyright.
* This release is licensed for deployment and use only with Cloud Copy Inc.'s Address Book application.
* All other distribution and use is forbidden.
* This comment block must be retained in all deployments.
*******************************************************************************************************/
Floatbox.prototype.customPaths={installBase:"",modules:"",languages:"",graphics:""};function Floatbox(){var a=this;a.proto=Floatbox.prototype;a.extend=function(){var d=arguments,h=d[0]||{},g,c,f;for(var e=1,b=d.length;e<b;e++){if((g=d[e])&&typeof g==="object"){for(c in g){if(g.hasOwnProperty(c)&&(f=g[c])!==a[fb.VT]){h[c]=f}}}}return h};a.CG=[];a.HG=function(c){var b;while((b=a.CG.shift())){b()}}}self.fb=new Floatbox;fb.extend(fb.proto,{PA:"absolute",PB:"activateElements",PC:"addEvent",PD:"addEventListener",PE:"afterFBLoaded",PF:"afterItemEnd",PG:"appendChild",PH:"array",PI:"auto",PJ:"autoFitHTML",PK:"autoFitSpace",PL:"autoStart",PM:"backgroundColor",PN:"backgroundImage",PO:"backgroundPosition",PP:"beforeItemEnd",PQ:"beforeItemStart",PR:"boolean",PS:"borderWidth",PT:"caption",PU:"caption2Left",PV:"className",PW:"clientHeight",PX:"clientWidth",PY:"colorTheme",PZ:"compareDocumentPosition",QA:"controlsCorner",QB:"controlsLeft",QC:"controlsPos",QD:"Corner",QE:"cornerRadius",QF:"createElement",QG:"currentIndex",QH:"currentItem",QI:"customPaths",QJ:"defaultView",QK:"disableScroll",QL:"display",QM:"document",QN:"documentElement",QO:"draggerLocation",QP:"enableDragMove",QQ:"enableDragResize",QR:"enableKeyboardNav",QS:"enableQueryStringOptions",QT:"encodeHTML",QU:"executeJS",QV:"fbBoxLiner",QW:"fbCaliper",QX:"fbCaption",QY:"fbCaption2",QZ:"fbContent",RA:"fbContentWrapper",RB:"fbControls",RC:"fbCornerBottom",RD:"fbCornerRight",RE:"fbCorners2",RF:"fbCornerTop",RG:"fbDragger",RH:"fbIframeHider",RI:"fbIndexLinks",RJ:"fbInfoLink",RK:"fbItemNumber",RL:"fbLeftNav",RM:"fbLoaderGif",RN:"fbNavControls",RO:"fbNewWindowLink",RP:"fbOverlay",RQ:"fbOverlayNext",RR:"fbOverlayPrev",RS:"fbPrintLink",RT:"fbResizer",RU:"fbRightNav",RV:"fbShadows",RW:"fbSubControls",RX:"fbZoomDiv",RY:"fbZoomImg",RZ:"firstChild",SA:"fixed",SB:"frame",SC:"function",SD:"getAttribute",SE:"getElementById",SF:"getElementsByClassName",SG:"getElementsByTagName",SH:"getIframeDocument",SI:"getIframeWindow",SJ:"getLayout",SK:"getOuterHTML",SL:"getScroll",SM:"getStyle",SN:"getViewport",SO:"getViewportHeight",SP:"getViewportWidth",SQ:"globalOptions",SR:"hidden",SS:"iframe",ST:"image",SU:"imageFadeDuration",SV:"indexLinksCorner",SW:"indexOf",SX:"infoLinkCorner",SY:"inline",SZ:"innerBorder",TA:"innerHTML",TB:"instances",TC:"itemNumberCorner",TD:"lastChild",TE:"loadPageOnClose",TF:"maxIndexThumbSize",TG:"media",TH:"mousemove",TI:"mouseout",TJ:"mouseover",TK:"mouseup",TL:"moveWithMouse",TM:"newWindowLinkCorner",TN:"nodeContains",TO:"nodeType",TP:"nofloatbox",TQ:"none",TR:"numIndexLinks",TS:"object",TT:"offsetHeight",TU:"offsetLeft",TV:"offsetTop",TW:"offsetWidth",TX:"onclick",TY:"onmousemove",TZ:"onmouseout",UA:"onmouseover",UB:"onreadystatechange",UC:"outerBorder",UD:"outsideClickCloses",UE:"overlayFadeDuration",UF:"overlayOpacity",UG:"ownerDocument",UH:"paddingBottom",UI:"paddingLeft",UJ:"paddingRight",UK:"Panel",UL:"parentNode",UM:"parentWindow",UN:"position",UO:"printLinkCorner",UP:"proportional",UQ:"proportionalResize",UR:"Radius",US:"removeAttribute",UT:"removeChild",UU:"removeEvent",UV:"replace",UW:"resizeDuration",UX:"resizeTool",UY:"roundCorners",UZ:"setAttribute",VA:"setInnerHTML",VB:"setRequestHeader",VC:"shadowSize",VD:"shadowType",VE:"showContent",VF:"showHints",VG:"showItemNumber",VH:"showNavOverlay",VI:"showNewWindowIcon",VJ:"showPlayPause",VK:"silverlight",VL:"slideshow",VM:"splitResize",VN:"stopEvent",VO:"string",VP:"strings",VQ:"substring",VR:"toLowerCase",VS:"touchstart",VT:"undefined",VU:"visibility",VV:"visible",VW:"WidgetDiv",VX:"winload"});(function(){var a=true,b=false,c=null;fb.extend(fb.proto,{version:"4.21.cloudsponge",build:"2010/11/23",CC:{roundCorners:"all",cornerRadius:12,shadowType:"drop",shadowSize:12,outerBorder:1,innerBorder:1,padding:24,panelPadding:8,overlayOpacity:55,doAnimations:a,resizeDuration:3.5,imageFadeDuration:3,overlayFadeDuration:4,startAtClick:a,zoomImages:a,splitResize:"no",colorTheme:fb.PI,autoFitImages:a,autoFitHTML:a,autoFitMedia:a,autoFitSpace:5,resizeImages:a,resizeTool:"cursor",liveImageResize:a,enableDragResize:b,stickyDragResize:a,draggerLocation:fb.SB,boxLeft:fb.PI,boxTop:fb.PI,captionPos:"bl",caption2Pos:"tc",infoLinkPos:"bl",printLinkPos:"bl",newWindowLinkPos:"tr",itemNumberPos:"bl",indexLinksPos:"br",controlsPos:"br",centerNav:b,enableDragMove:a,stickyDragMove:a,showClose:a,showItemNumber:a,showNewWindowIcon:a,closeOnNewWindow:b,controlsType:fb.PI,strongControls:b,showHints:"once",outsideClickCloses:a,imageClickCloses:b,enableKeyboardNav:a,navType:"both",navOverlayWidth:35,navOverlayPos:30,showNavOverlay:"never",enableWrap:a,numIndexLinks:0,showIndexThumbs:a,pipIndexThumbs:a,maxIndexThumbSize:0,randomOrder:b,slideInterval:4.5,endTask:"exit",showPlayPause:a,startPaused:b,pauseOnPrev:a,pauseOnNext:b,pauseOnResize:a,cycleInterval:5,cycleFadeDuration:4.5,cyclePauseOnHover:b,licenseKey:"eml5v65Av65yzWlGtqN9srlCvKhzwKg3eUT",titleAsCaption:a,hideObjects:a,hideJava:a,showIE6EndOfLife:b,modal:a,centerOnResize:a,disableScroll:b,cacheAjaxContent:b,youtubeAutoEnd:a,preloadAll:a,language:fb.PI,floatboxClass:"floatbox",cycleClass:"fbCycler",tooltipClass:"fbTooltip",ie9betaSafe:a},HQ:20,ER:16,BO:60,LF:1,BP:8,GH:140,GG:100,JQ:750,FY:120,GI:70,IN:15,CS:45,FU:Math.ceil,FV:Math.floor,FW:Math.log,O:Math.max,P:Math.min,FX:Math.random,Q:Math.round,EQ:Infinity,KF:String.fromCharCode,DJ:function(d){return parseInt(d,10)},DG:function(d){return parseFloat(d)},I:function(d,e){return setTimeout(d,e)},KV:function(d){return !!(d&&d.D&&d.KG!=="direct"&&d.KG!==fb.SY)},HD:function(){return(new Date).getTime()},AO:(location.protocol+"//"+location.host)[fb.VR](),AV:(navigator.language||navigator.userLanguage||navigator.systemLanguage||navigator.AV||"en")[fb.VQ](0,2),instances:[],children:[],anchors:[],G:[],X:[],HW:[],HX:[],AD:[],GK:{},HZ:{},CQ:{},L:{},HP:{},CR:{},JX:function(){if(!document.body){return fb.I(fb.JX,50)}var d="self",f=(self.fbPageOptions&&fbPageOptions.framed)||/framed/.test(fb.FH);if(!(f||self===parent)){try{if(!fb.FD(parent.location.href)){d="parent"}}catch(g){}if(d==="parent"&&!(parent.fb&&parent.fb.ET)){return fb.I(fb.JX,50)}}if(document.compatMode==="BackCompat"){alert("Floatbox does not support quirks mode.\nPage needs to have a valid doctype declaration.");return}if(d==="self"){fb.ES()}else{self.fb=parent.fb}(function(){var e=self[fb.QM],h=e&&e.body;if(!(h&&fb.ET)){return fb.I(arguments.callee,50)}fb.AD.push(self);document.fbAnchorCount=h[fb.SG]("a").length;if(fb.EM){fb.proto.BG=fb.DT(fb.DC())}fb[fb.PB](h);fb[fb.PC](fb.ie?h:e,"mousedown",function(i){try{fb.BI=i.clientX;fb.BJ=i.clientY;fb.BH=i.target;fb.I(function(){try{fb.BI=fb.BJ=fb.BH=c}catch(j){}},250)}catch(i){}});if(d==="self"){fb.K(c,fb.PE)}if(fb[fb.PL]){fb.I(function(){if(!fb.AN){fb.AN=a;fb.start(fb[fb.PL])}},100)}if(fb.EK===a){fb.DK("ie6")}})()},ES:function(){var l=this,h=fb.proto;function j(n){return n+(n[fb.VQ](n.length-1)==="/"?"":"/")}if(!l.EX){h.EX=j(l[fb.QI].installBase||l.DN("script","src",/(.*)floatbox.js(?:\?|$)/i)||l.DN("link","href",/(.*)floatbox.css(?:\?|$)/i)||"/floatbox/")}if(!l[fb.SQ]){l.DK("options",l.EX);l.I(function(){l.ES()},25);return}l[fb.TB].push(l);l.M=l.JS=l[fb.TB].length-1;l.F=[];l.HB=[];l.EA=[];l.KL={};l.T={};l.BU={};l.EZ=fb.ET;if(!l.EZ){l.parent=l.fbParent=l.topBox=l[fb.TD]=l;l.DM();var f={},k=navigator.userAgent,d=navigator.appVersion,i;function e(o,n){return l.DG(o.split(n)[1])}f.FS=d[fb.SW]("Macintosh")>-1;if(l.EN){f.ie=a;f.ie9=l.EN===9;f.EM=l.EN<9;f.EL=l.EN<8;f.EK=l.EN<7;f.EO=(i=e(d,"Windows NT "))&&i<6;f.EI=d[fb.SW](" x64;")>0}else{if(window.opera){f.opera=a;if(/Opera M(ob|in)i/.test(k)){f.mobile=a}else{f.HJ=opera.version()<9.5;f.HI=opera.version()>=10.5}}else{if(k[fb.SW]("AppleWebKit")>=0){f.KZ=a;f.LA=f.FS;f.mobile=k[fb.SW]("Mobile")>=0}else{if((i=e(k,"Firefox/"))){f.ff=a;f.CW=i<3;f.CV=!f.CW;f.CU=f.FS}else{if((i=e(k,"SeaMonkey/"))){f.seaMonkey=a;f.IZ=i<2}}}}}if(/Kindle|nook brow/.test(k)){f.IF=a}l.extend(h,f,{HE:{},Z:self,H:document,CE:document[fb.QN],CF:document[fb.SG]("head")[0],C:document.body,GJ:j(l[fb.QI].modules||l.EX+"modules/"),FK:j(l[fb.QI].languages||l.EX+"languages/"),DP:j(l[fb.QI].graphics||l.EX+"graphics/"),rtl:l[fb.SM](document.body,"direction")==="rtl"});l.DK("core")}else{l.parent=l.fbParent=fb[fb.TD];fb.topBox=fb[fb.TD]=l;fb.children.push(l)}var m=l.DP;l.IO=m+"magnify_plus.cur";l.IK=m+"magnify_minus.cur";l.HC=m+"404.jpg";l.AQ=m+"blank.gif";var g=/\bautoStart=(.+?)(?:&|$)/i.exec(location.search);l.AM=g?g[1]:c;l.ET=a;return l},DN:function(e,d,j){var h=document[fb.SG](e),g=h.length,f;while(g--){if((f=j.exec(h[g][d]))){return f[1]||"./"}}return""},DM:function(){var e=this,d;function f(i){var h={},g;for(g in i){if(i.hasOwnProperty(g)){h[g==="img"?fb.ST:g]=e.HS(i[g])}}return h}e.L.L=e[fb.SQ].globalOptions||{};e.L.BC=e[fb.SQ].childOptions||{};e.L.KS=f(e[fb.SQ].typeOptions);e.L.BE=f(e[fb.SQ].classOptions);e.HP.L=self.fbPageOptions||{};e.HP.BC=self.fbChildOptions||{};e.HP.KS=f(self.fbTypeOptions);e.HP.BE=f(self.fbClassOptions);if((e.L.L.enableCookies||e.HP.L.enableCookies)&&(d=/fbOptions=(.+?)(;|$)/.exec(document.cookie))){e.extend(e.CR,e.HS(d[1]))}if(e.L.L[fb.QS]||e.HP.L[fb.QS]||(location.search&&/enableQueryStringOptions=true/i.test(location.search))){e.extend(e.CR,e.HS(location.search[fb.VQ](1)))}e.JE(e.CC);e.JE(e.L.L);e.JE(e.HP.L);e.JE(e.CR)},JD:function(d,e){var g=this,i={},h=g.L,j=g.HP,f=((d.AH||"")+" "+(d.FF.BD||""))[fb.UV](/\s+/g," ")[fb.UV](/^\s+|\s+$/g,"").split(" ");function k(n){var l={},m=f.length;while(m--){g.extend(l,n.BE[f[m]])}return l}g.extend(i,g.CC,h.L);if(e){g.extend(i,h.BC)}g.extend(i,h.KS[d.type]);if(d.KG){g.extend(i,h.KS[d.KG])}g.extend(i,k(h),j.L);if(e){g.extend(i,j.BC)}g.extend(i,j.KS[d.type]);if(d.KG){g.extend(i,j.KS[d.KG])}g.extend(i,k(j),g.CR,d.FF);if(!d.HL){d.HL=i}return(d.W=i)},tagAnchors:function(d){this[fb.PB](d)},activateElements:function(g){var n=this;if(!n.ET){return n.I(function(){n[fb.PB](g)},50)}if(!(g=fb$(g))){if(n.CB){n.CB(-1)}for(var k=0;k<n.AD.length;k++){try{if(n.AD[k]&&n.AD[k][fb.QM]){n[fb.PB](n.AD[k][fb.QM])}}catch(l){}}return}function h(o){var q=g[fb.SG](o);for(var p=0,e=q.length;p<e;p++){n.HR(q[p],c,b,m)}}function d(t,o){var s=n.HS(t[fb.SD]("data-fb-options")||t[fb.SD]("rev")||""),q=t[fb.SG](o),r=q.length;if(!s.autoTypes){s.autoTypes="image|media|html"}s.BD=t[fb.PV];while(r--){var e=q[r];if(!/\bnofloatbox\b/i.test(e[fb.PV]+" "+e[fb.SD]("rel"))){var u=n.HS(e[fb.SD]("data-fb-options")||e[fb.SD]("rev")||""),p=n.extend({},s,u);e[fb.UZ]("data-fb-options",n.FT(p))}}}var m=n.ownerInstance(g),j=n[fb.SF](n.floatboxClass,g[fb.UG]||g),k=j.length;while(k--){var f=j[k];if(!/^a(rea)?$/.test(n.J(f))){d(f,"a");d(f,"area")}}h("a");h("area")},HR:function(d,h,m,p){var r=this,q={},n;q.FF=h||{};d=d||q.FF.source||q.FF.html||q.FF.href;if(!d&&q.FF.showThis!==b){return}q.source=q.D=d;var l=r.anchors.length;while(l--){if(r.anchors[l].source===d){return m?r.anchors[l]:r[fb.VT]}}q.KH=m;if(m){q.M=fb[fb.TD].M}else{q.M=isNaN(p)?r.ownerInstance(q.AE):p}if(r.typeOf(d)==="node"){if(/^a(rea)?$/.test(r.J(d))){var k=r.HS(d[fb.SD]("data-fb-options")||d[fb.SD]("rev"));q.FF=r.extend(k,q.FF);q.href=d.href||"";try{q.href=decodeURI(q.href)}catch(o){}q.AI=d[fb.SD]("rel")||"";q.AJ=d[fb.SD]("title")||"";q.AH=d[fb.PV]||"";q.HO=d[fb.UG];q.AE=d;q.KK=d[fb.SG]("img")[0]||c;if((n=(new RegExp("\\b"+r.floatboxClass+"(\\S*)","i")).exec(q.AH))){q.KH=a;if(n[1]){q.group=n[1]}}else{if(r.HP.L.autoGallery&&!/\bnofloatbox\b/i.test(q.AH+" "+q.AI)&&r.CX(q.href)===fb.ST){q.KH=a;q.group=".autoGallery"}else{if((n=/^(?:floatbox|gallery|iframe|slideshow|lytebox|lyteshow|lyteframe|lightbox)(.*)/i.exec(q.AI))){q.KH=a;q.group=n[1];if(/^(slide|lyte)show/i.test(q.AI)){q.FF.doSlideshow=a}else{if(/^(i|lyte)frame/i.test(q.AI)){q.type="html";q.KG=fb.SS}}}}}if(q.KK&&((n=/(?:^|\s)fbPop(up|down|left|right|pip)(?:\s|$)/i.exec(q.AH)))){q.HY=n[1];r.HX.push(q)}}else{q.type="html";q.KG=fb.SY}}q.D=q.FF.source||q.FF.href||q.href||d;if(!q.type){q.D=r.decodeHTML(q.D);if(/<.+>/.test(q.D)){q.type="html";q.KG="direct"}else{if((n=/#([a-z][^\s=]*)$/i.exec(q.D))){var j=r.CY(n[1],q.HO);if(j){q.D=j;q.type="html";q.KG=fb.SY}}}if(!q.type){q.type=(q.FF.type||r.CX(q.D))[fb.VR]();if(q.type==="img"){q.type=fb.ST}if(/^(iframe|inline|ajax|direct)$/.test(q.type)){q.KG=q.type;q.type="html"}if(/^(flash|quicktime|wmp|silverlight|pdf)$/.test(q.type)){q.KG=q.type;q.type=fb.TG}}}if(!q.KH&&q.FF.autoTypes&&(q.FF.autoTypes[fb.SW](q.type)>-1||(q.KG&&q.FF.autoTypes[fb.SW](q.KG)>-1))){q.KH=a}if(!q.KH){return}if(r.ie&&q.KG==="pdf"&&r.FD(q.D)){q.type="html";q.KG=fb.SS}if(q.KG===fb.SY){q.BN=r.LC(q.D)}r.JD(q);q.group=q.W.group||q.group||"";if(m){r.anchors.splice(0,0,q)}else{r.anchors.push(q)}if(q.type===fb.TG){r.DK(fb.TG)}if(q.href&&!fb[fb.PL]){if(r.AM){if(q.W.showThis!==b&&q.href[fb.SW](r.AM)>-1){fb[fb.PL]=q}}else{if(q.W[fb.PL]===a){fb[fb.PL]=q}else{if(q.W[fb.PL]==="once"){var n=/fbAutoShown=(.+?)(?:;|$)/.exec(document.cookie),g=n?n[1]:"",f=escape(q.href);if(g[fb.SW](f)===-1){fb[fb.PL]=q;document.cookie="fbAutoShown="+g+f+"; path=/"}}}}}if(r.EK&&q.AE){q.AE.hideFocus="true"}if(q.AE&&!m){r[fb.PC](q.AE,"click",r.DC(q,r),r.BG,q.M);q.AE[fb.TX]=c}if(m){return q}},DC:function(d,e){return function(f){if(!(f&&(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey))||d.W.showThis===b||(d.type!==fb.ST&&d.KG!==fb.SS)){e.start(this);return e[fb.VN](f)}}},CX:function(j){if(typeof j!==fb.VO){return""}var g=j.search(/[\?#]/),f=(g!==-1)?j[fb.VQ](0,g):j,g=f.lastIndexOf(".")+1,h=g?f[fb.VQ](g)[fb.VR]():"",e,k={youtube:/\.com\/(watch\?v=|watch\?(.+)&v=|v\/[\w\-]+)/,"video.yahoo":/\.com\/watch\/\w+\/\w+/,dailymotion:/\.com\/swf\/\w+/,vimeo:/\.com\/\w+/,vevo:/\.com\/(watch\/\w+|videoplayer\/(index|embedded)\?)/i};if(/^(jpe?g|png|gif|bmp)$/.test(h)){return fb.ST}if(!h||/^(html?|php\d?|aspx?)$/.test(h)){return fb.SS}if(h==="swf"){return"flash"}if(h==="pdf"){return"pdf"}if(h==="xap"){return fb.VK}if(/^(mpe?g|movi?e?|3gp|3g2|m4v|mp4|m1v|mpe|qt)$/.test(h)){return"quicktime"}if(/^(wmv?|avi|asf)$/.test(h)){return"wmp"}if((e=/^(?:http:)?\/\/(?:www.)?([a-z\.]+)\.com\//i.exec(f))&&e[1]){var d=e[1][fb.VR]();if(k[d]&&k[d].test(j)){return"flash"}}return fb.SS},CY:function(j,f){var e=this,h=c;if(typeof j===fb.VO){h=(f&&f[fb.SE](j))||e.H[fb.SE](j)||fb$(j);var d=fb[fb.TB].length,g;while(!h&&d--&&(g=fb[fb.TB][d])){if(e.J(g[fb.QZ])===fb.SS&&!e.FD(g[fb.QZ].src)){if((f=e[fb.SH](g[fb.QZ]))){h=f[fb.SE](j)}}}}return h},LC:function(g){var f=this,d=g[fb.UL],e="fbWrapper";if(d[fb.PV]===e){return d}else{var h=g[fb.UG][fb.QF]("div");h[fb.PV]=e;h.style[fb.QL]=f[fb.SM](g,fb.QL);h.style[fb.VU]=f[fb.SM](g,fb.VU);d.replaceChild(h,g);h[fb.PG](g);if(f[fb.SM](g,fb.QL)===fb.TQ){g.style[fb.QL]="block"}if(f[fb.SM](g,fb.VU)===fb.SR){g.style[fb.VU]=fb.VV}return h}},HS:function(m){var p=this,l={},n=p.typeOf(m);if(n===fb.TS){return m}if(!m||n!==fb.VO){return l}var k=[],j,h=/`([^`]*?)`/g;h.lastIndex=0;while((j=h.exec(m))){k.push(j[1])}if(k.length){m=m[fb.UV](h,"``")}m=m[fb.UV](/[\r\n]/g," ");m=m[fb.UV](/\s{2,}/g," ");m=m[fb.UV](/\s*[:=]\s*/g,":");m=m[fb.UV](/\s*[;&,]\s*/g," ");m=m[fb.UV](/^\s+|\s+$/g,"");m=m[fb.UV](/(:\d+)px\b/gi,"$1");var e=m.split(" "),g=e.length;while(g--){var f=e[g].split(":"),d=f[0],o=f[1];if(d){if(!isNaN(o)){o=+o}else{if(o==="true"){o=a}else{if(o==="false"){o=b}else{if(o==="``"){o=k.pop()||""}}}}l[d]=o}}return l},FT:function(f){var e="",d,g;for(d in f){g=f[d];if(g!==""){if(/[:=&;,\s]/.test(g)){g="`"+g+"`"}e+=d+":"+g+" "}}return e},JE:function(f){var e=this;for(var d in f){if(e.CC.hasOwnProperty(d)&&f[d]!==""){e[d]=f[d]}}},DK:function(e,f){var d=fb;if(e&&!(d[e+"Loaded"]||d.GK[e])){if(!/core|options/.test(e)&&!d.coreLoaded){return d.I(function(){d.DK(e,f)},120)}d.GK[e]=a;d[fb.QU]((f||d.GJ)+e+".js"+d.FH)}},executeJS:function(d,l){var m=this,k=m.H||document,j=m.CF||k[fb.SG]("head")[0]||k[fb.QN],g=k[fb.QF]("script");function f(){j[fb.UT](g);g=g.onload=g[fb.UB]=c;if(m.typeOf(l)===fb.SC){l()}}g.type="text/javascript";if(l===a){fb.execRtn=m[fb.VT];if(!/[\n\r]/.test(d)){d='fb.execRtn = eval("'+d[fb.UV](/\\/g,"\\\\")[fb.UV](/"/g,'\\"')+'")'}try{g[fb.PG](document.createTextNode(d))}catch(h){g.text=d}j[fb.PG](g);var i=fb.execRtn;f();delete fb.execRtn;return i}else{g.onload=g[fb.UB]=function(){if(/^$|complete|loaded/.test(this.readyState||"")){f()}};g.src=d;j.insertBefore(g,j[fb.RZ])}},getStyle:function(l,e,q){var r=this,g;function o(s){return q?r.Q(r.DG(s)||0):s||""}if(!(l=fb$(l))){return c}if(window.getComputedStyle){var f=l[fb.UG]&&l[fb.UG][fb.QJ];if(!(g=f&&f.getComputedStyle(l,""))){return c}if(e){e=e[fb.UV](/([A-Z])/g,"-$1")[fb.VR]();return o(g.getPropertyValue(e))}}e=e&&e[fb.UV](/-(\w)/g,function(s,t){return t.toUpperCase()});if(l.currentStyle){g=l.currentStyle;if(e){var m=g[e]||"";if(/^[\.\d]+[^\.\d]/.test(m)&&!/^\d+px/i.test(m)){var p=l[fb.UG],i=p[fb.QF]("xxx"),n,h;if(/html|body/.test(fb.J(l))){n=l;h=l[fb.RZ]}else{n=l[fb.UL];h=l}n.insertBefore(i,h);i.style.left=m;m=i.style.pixelLeft+"px";n[fb.UT](i)}return o(m)}}if(g&&!e){var k="",d,j;if(g.cssText){k=g.cssText}else{for(d in g){j=g[d];if(isNaN(d)&&j&&typeof j===fb.VO){k+=d[fb.UV](/([A-Z])/g,"-$1")[fb.VR]()+": "+j+"; "}}}return k}return o((l.style&&e&&l.style[e])||"")},addEvent:function(g,j,h,n,l){var p=this;if((g=fb$(g))){if(g[fb.TO]==9&&/^DOMContentLoaded$/i.test(j)){var k=p.CG.length;while(k--){if(p.CG[k]===h){break}}if(k===-1){p.CG.push(h)}}else{if(g[fb.PD]){g[fb.PD](j,h,b)}else{if(g.attachEvent){if(!n){n=p.DT(h)}p[fb.UU](g,j,h,n);var f="on"+j,m=j+n,e=f+n,o=g[fb.UG]||g,d=o[fb.UM]||g;g[m]=h;g[e]=function(q){if(!q){var i=g[fb.UG];q=i&&i[fb.UM]&&i[fb.UM].event}if(q&&!q.target){q.target=q.srcElement}if(g&&g[m]){return g[m](q)}};g.attachEvent(f,g[e])}}}if(l||l===0){if(!fb.CQ[l]){fb.CQ[l]=[]}fb.CQ[l].push({a:g,b:j,c:h,d:n})}}return h},removeEvent:function(g,i,h,l){var m=this;g=fb$(g);try{if(!(g&&(g[fb.TO]||g[fb.QM]))){return}}catch(j){return}if(g[fb.PD]){g.removeEventListener(i,h,b)}else{if(g.detachEvent){if(!l){l=m.DT(h)}var f="on"+i,k=i+l,d=f+l;if(g[d]){g.detachEvent(f,g[d])}g[d]=g[k]=c}}},DT:function(g){var f=g+"",e=f.length,d=e;while(d--){e=((e<<5)^(e>>27))^f.charCodeAt(d)}return e},stopEvent:function(f){if((f=f||window.event)){if(f.stopPropagation){f.stopPropagation()}if(f.preventDefault){f.preventDefault()}try{f.cancelBubble=a}catch(d){}try{f.returnValue=b}catch(d){}try{f.cancel=a}catch(d){}}return b},getElementsByClassName:function(n,f){var p=this;if(p.typeOf(n)===fb.PH){var o=arguments.callee,d=n.pop();if(n.length){return o(n,f).concat(o(d,f))}else{n=d}}var m=[],e,k,g,l;if(/\[native code\]/.test(f[fb.SF])){e=f[fb.SF](n);k=e.length;while(k--){m[k]=e[k]}}else{var h=new RegExp("(^|\\s)"+n+"(\\s|$)");e=f[fb.SG]("*");for(k=0,g=0,l=e.length;k<l;k++){if(h.test(e[k][fb.PV])){m[g++]=e[k]}}}return m},typeOf:function(e){var f=typeof e;if(f===fb.TS){if(e){var g=Object.prototype.toString.call(e)[fb.VR](),d;if((d=/(array|string)/.exec(g))){f=d[1]}else{if(e[fb.TO]&&e.cloneNode&&e.constructor!==Object){f="node"}}}else{f="null"}}else{if(f==="unknown"){f=fb.SC}}return f},J:function(d){return((d&&d.nodeName)||"")[fb.VR]()},ownerInstance:function(j){if(!(j=fb$(j))){return}var f=this,l,h,g,e=j[fb.UG]||j,d=fb[fb.TB].length;function k(m){var o=f[fb.SH](m);if(o===e){return a}var n=(o||m)[fb.SG](fb.SS),i=n.length;while(i--){if(k(n[i])){return a}}return b}while(d--){if((l=fb[fb.TB][d])&&(h=l.fbBox)){if(f[fb.TN](h,j)||((g=l[fb.QZ])&&k(g))){return d}}}return -1},nodeContains:function(d,e){if(!((d=fb$(d))&&(e=fb$(e)))){return}if(e[fb.TO]==3){e=e[fb.UL]}if(d===e){return a}if(!e[fb.TO]||e[fb.TO]==9){return b}if(d[fb.TO]==9){d=d[fb.QN]}if(d.contains){return d.contains(e)}if(d[fb.PZ]){return !!(d[fb.PZ](e)&16)}},hasAttribute:function(f,e){if(!(f=fb$(f))){return}var d=this;if(f.hasAttribute){return f.hasAttribute(e)}return(new RegExp("<[^>]+[^>\\w-=\"']"+e+"[^\\w\\-]","i")).test(d[fb.SK](f))},encodeHTML:function(d){if(typeof d!==fb.VO){return d}return d[fb.UV](/&/g,"&amp;")[fb.UV](/</g,"&lt;")[fb.UV](/>/g,"&gt;")[fb.UV](/"/g,"&quot;")},decodeHTML:function(d){if(typeof d!==fb.VO){return d}return d[fb.UV](/&lt;/g,"<")[fb.UV](/&gt;/g,">")[fb.UV](/&quot;/g,'"')[fb.UV](/&apos;/g,"'")[fb.UV](/&amp;/g,"&")},setInnerHTML:function(d,h){if(!(d=fb$(d))){return b}try{d[fb.TA]=h;return a}catch(l){}try{var m=d[fb.UG],j=m.createRange();j.selectNodeContents(d);j.deleteContents();if(h){var f=(new DOMParser).parseFromString('<div xmlns="http://www.w3.org/1999/xhtml">'+h+"</div>","application/xhtml+xml"),n=f[fb.QN].childNodes;for(var g=0,k=n.length;g<k;g++){d[fb.PG](m.importNode(n[g],a))}}return a}catch(l){}return b},getOuterHTML:function(d){if(!(d=fb$(d))){return""}if(d.outerHTML){return d.outerHTML}var e=(d[fb.UG]||d[fb.QM])[fb.QF]("div");e[fb.PG](d.cloneNode(a));return e[fb.TA]},getIframeWindow:function(g){var f=this,d=fb.SS;g=fb$(g);if(f.J(g)!==d){if(f.J(f[fb.QZ])===d){g=f[fb.QZ]}else{if(f.J(fb[fb.TD][fb.QZ])===d){g=fb[fb.TD][fb.QZ]}}}if(f.J(g)===d){try{var i=g.contentWindow||(g.contentDocument&&g.contentDocument[fb.QJ]);if(i.location.href){return i}}catch(h){}}return c},getIframeDocument:function(e){var d=this,f=d[fb.SI](e);return(f&&f[fb.QM])||c},FD:function(e){var d=this;if(typeof e!==fb.VO){return a}if(e&&e[fb.SW]("//")===0){e=(d.Z||self).location.protocol+e}return/^https?:\/\/\w/i.test(e)&&e[fb.VR]()[fb.SW](fb.AO)!==0},flashObject:function(){var l=this,j=arguments,m=j[0];if(l.typeOf(m)!==fb.TS){m={url:j[0],width:j[1],height:j[2],params:j[3],node:j[4],id:j[5],altContent:j[6]}}var k=m.width?(m.width+"")[fb.UV]("px",""):"100%",g=m.height?(m.height+"")[fb.UV]("px",""):"100%",e={wmode:"opaque",scale:"exactfit",play:"false",quality:"high"},f=fb$(m.node);l.extend(e,l.HS(m.params));var i='<object class="fbFlashObject" width="'+k+'" height="'+g+'" '+(m.id?'id="'+m.id+'" ':"");if(l.EN){i+='classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,115,0"><param name="movie" value="'+m.url+'" />'}else{i+='type="application/x-shockwave-flash" data="'+m.url+'"><param name="pluginspage" value="http://get.adobe.com/flashplayer/" />'}for(var d in e){if(e.hasOwnProperty(d)){i+='<param name="'+d+'" value="'+e[d]+'" />'}}i+=(m.altContent||"")+"</object>";if(f&&f[fb.TO]==1){l[fb.VA](f,i)}else{document.write(i)}},start:function(f,d){var e=this;e.I(function(){e.start(f,d)},100)},preload:function(e,g,f){var d=this;d.I(function(){d.preload(e,g,f)},250)},BW:function(e,f){var d=this;d.I(function(){d.BW(e,f)},200)},KN:function(f,e,g){var d=this;d.I(function(){d.KN(f,e,g)},200)},HU:function(e){var d=this;d.I(function(){d.HU(e)},150)},translate:function(f,d,g){var e=this;e.I(function(){e.translate(f,d,g)},200)},ajax:function(h,g){var d=this;if(g===d[fb.VT]){if(window.XMLHttpRequest){g=new XMLHttpRequest}else{try{g=new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(f){try{g=new ActiveXObject("Msxml2.XMLHTTP")}catch(f){}}}}g=g||b;d.I(function(){d.ajax(h,g)},200);return g},printNode:function(f,e){var d=this;d.I(function(){d.printNode(f,e)},200)},K:function(e,f){var d=this;d.I(function(){d.K(e,f)},200)}})})();var fb$=function(a){return typeof a===fb.VO?(document[fb.SE](a)||null):a};if(typeof fb.EN===fb.VT){fb.proto.FH=fb.DN("script","src",/floatbox.js(\?.*)$/i);fb.proto.EN=0;(function(){var a=document[fb.QF]("div");fb[fb.VA](a,'<!--[if IE]><div id="fb_ieChk"></div><![endif]-->');if(a[fb.RZ]&&a[fb.RZ].id==="fb_ieChk"){if(document.documentMode){fb.proto.EN=document.documentMode}else{fb[fb.VA](a,'<!--[if lt IE 7]><div id="fb_ie6"></div><![endif]-->');fb.proto.EN=a[fb.RZ]&&a[fb.RZ].id==="fb_ie6"?6:7}}fb[fb.VA](a,"");a=null})()}if(fb.EN&&fb.EN<9){document.write('<xml:namespace ns="urn:schemas-microsoft-com:vml" prefix="v" />')}fb[fb.PC](document,"DOMContentLoaded",fb.JX);fb[fb.PC](window,"load",function(){fb.HG();var g=self[fb.QM].body;if(!(g&&fb.ET)){return fb.I(arguments.callee,50)}if(g[fb.SG]("a").length>document.fbAnchorCount){fb[fb.PB](g)}try{var b=parent.fb[fb.TD];if(b[fb.SI]()===self){if(b.coreLoaded&&b.IY==="no"){b.resize()}if(!b.modal){b[fb.PC](document[fb.QN],"click",function(){if(b!==parent.fb.topBox){b.IP()}})}}}catch(f){}var c;if(self===fb.Z&&fb[fb.VD]!==fb.TQ&&fb[fb.VC]){var d=fb.DP+"shadow",a="_s"+fb[fb.VC]+"_r"+fb[fb.QE]+".png";c=[fb.AQ,d+"Top"+a,d+"Right"+a,d+fb.QD+a,d+fb.QD+a[fb.UV]("_r"+fb[fb.QE],"_r0"),d+"Bottom"+a,d+"Left"+a]}fb.I(function(){if(self.fb){fb.preload(c,null,true)}},200);fb[fb.PC](window,"unload",function(){if(self.fb&&fb.E&&fb.Z===self){fb.E("*");var e=fb[fb.TB].length;while(e--){fb.CB(e);fb.CD(e)}fb.CB(-1);var e=fb.HZ.length;while(e--){fb.HZ[e]=null}}})});if(document[fb.PD]){document[fb.PD]("DOMContentLoaded",fb.HG,false)};(function(){/*@cc_on try{document.body.doScroll('up');return fb.HG();}catch(e){}/*@if (false) @*/if(/loaded|complete/.test(document.readyState))return fb.HG();/*@end @*/if(fb.CG.length)fb.I(arguments.callee,20);})();
